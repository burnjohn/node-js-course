# Lesson 9

- Платформа Heroku
- Деплой приложения на Heroku 
- Выгрузка файлов на Amazon S3 

## Heroku

Heroku - это отличная площадка для хостинга проектов.

Для загрузки проекта heroku предоставляет удобные инструменты, на данный момент их 3 и это более чем достаточно. С двумя из трех многие давно знакомы, это GitHub и Dropbox. Третий инструмент Heroku Toolbelt, пожалуй, самый необходимый инструмент для тесной работы с платформой, позволяет создавать проекты, загружать исходный код, смотреть и настраивать конфиг, отдает логии и многое другое.

GitHub и Dropbox являются больше менеджерами загрузки проектов, с их помощью можно загружать проект на heroku, но инструментов для управления они не предоставляют. Если плотно работаете с GitHub, то можете настроить автоматический деплой проекта на heroku. Загрузку из Dropbox можно сделать только из веб интерфейса (dashboard) проекта на вкладке Deploy.

### Дино контейнеры

Пользуясь платформой вы часто сможете увидить такое слово как *dyno*.

Это специальные изолированые контейнеры с линуксом в которые помещаются приложения. Так же это "строительные блоки" которые позволяют расширять приложения не прикладывая лишних усилий. 

[Статья о dynos](https://www.heroku.com/dynos)

### Ограничения

Стоит сказать что платформа имеет ряд ограничений связаных как с особенностями платформы так и с бесплатным аккаунтом.

Например для бесплатного акаунта доступно только 512мб оперативки.

Проект погружается в "сон", если в течении часа к нему не было обращений. После обращения проект просыпается. Репозиторий не может превышать 1 Гб. 

[Список всех ограничений](https://devcenter.heroku.com/articles/limits)


## Деплой приложения

Деплой приложения можно разделить на несколько этапов:

### Настройка приложения
- Создание git репозитория с вашим проектом
- Обьявление переменных в конфиге
- Разделение конфига на приватный и публичный
- Распаковка фронтенда в репозиторий


### Публикация приложения на heroku
- установка heroku 
- создание проекта на heroku
- публикация проекта на heroku

[Инструкция на heroku](https://devcenter.heroku.com/articles/deploying-nodejs)


### Релизы

В любом приложении есть такое понятие как релиз. По факту это перенос какой-либо версии вашего приложения на продакшн сервер. Обычно команда выбирает правила релизов которым следует каждый член команды.

- continuous delivery
- feature releases

#### Continuous delivery (непрерывная доставка)
Каждая фича/фикс выкатывается на продакшн сразу же как пройдет ревью. Все фичи выкатываются отдельно друго от друга.

- разработчик заливает код в `staging` ветку
- на сервере непрерывной интеграции изменения объединяются с основным кодом, выполняются юнит – тесты и всё заливается на стэйжинг среду;
- в стэйжинг среде QA инженеры тестируют приложение;
- разработчик заливает код в `master`ветку
- разработчик деплоит код на продакшн (либо же автодеплой)

#### feature releases
Отдельная фича/фикс может быть выкачена в продакшн только с другими фичами и только в определенное время.

Обычно релизы происходят через какой-то промежуток времени, который определяется бизнес требованиями (возможно командой).

- разработчики заливает код в `develop` ветку
- в `develop` ветке находятся все фичи подготовленые к релизу
- в `develop` среде QA инженеры тестируют приложение;
- когда подходит время релиза и все баги зафикшены `develop` ветка мерджится в `master` 
- разработчики деплоят `master` на продакшн (либо же автодеплой)

[Git flow. Методология для работы с релизами](https://danielkummer.github.io/git-flow-cheatsheet/index.ru_RU.html)


Если релиз был неудачный. Например, сразу после релиза на продакшене нашли багу. В таких случаях последний релиз откатывают на предыдущий.

[Релизы на heroku](https://devcenter.heroku.com/articles/releases)


### Выгрузка файлов на Amazon S3 

Раздел в разработке ...

[Статья о выгрузке]https://devcenter.heroku.com/articles/s3